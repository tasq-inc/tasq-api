GetFullUserListSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Grab full users list"
    handler: src/functions/appsync_sources.get_full_user_list
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"


DeleteWorkflowSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Delete workflow"
    handler: src/functions/appsync_sources.delete_workflow
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"



GetWorkflowSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Get workflow"
    handler: src/functions/appsync_sources.get_workflow
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"

GetAllWorkflowsSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Get all workflows"
    handler: src/functions/appsync_sources.get_all_workflows
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"




PostWorkflowSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Post new workflow"
    handler: src/functions/appsync_sources.post_workflow
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"



UpdateWorkflowSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Update new workflow"
    handler: src/functions/appsync_sources.update_workflow
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"





GetUserDetailsSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Get user details"
    handler: src/functions/appsync_sources.get_user_details
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"



UpdateProfileSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Update user profile"
    handler: src/functions/appsync_sources.update_user_profile
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"



UserSignUpSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Sign up user"
    handler: src/functions/appsync_sources.sign_up_user
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"



VerifyInviteSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Verify invitation"
    handler: src/functions/appsync_sources.verify_invitation_id
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"


SendInviteSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Send invitation"
    handler: src/functions/appsync_sources.send_invitation_email
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"


GetReassignListSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Allow task reassignment"
    handler: src/functions/appsync_sources.get_reassignment_list
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"

ReassignTaskSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Allow task reassignment"
    handler: src/functions/appsync_sources.reassign_tasq
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"


GetTaskSyncSource:
    DependsOn: AppSyncSourceLambdaRole
    description: "Lambda data-source for appsync endpoint: Get task reassignment"
    handler: src/functions/appsync_sources.get_tasq
    memorySize: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceMemSize}}'
    timeout: '${{file(./src/resources/config.yml):ListPredictionsLambdaSourceTimeout}}'
    role: !GetAtt AppSyncSourceLambdaRole.Arn
    runtime: "${{self:provider.runtime}}"
    environment:
      USER_POOL: "${{file(./src/resources/config.yml):UserPool}}"
      WORKFLOW_OUTPUT_TABLE: !Ref WorkflowOutputTable
      WORKFLOW_DETAILS_TABLE: !Ref WorkflowDetailsTable
      USER_INVITE_OUTPUT_TABLE: !Ref UserInviteTable
      PREDICTIONS_LIST_TABLE: !ImportValue "${{self:provider.environment.PredictionsTableStackName}}:PredictionTable"
      WORKFLOW_HISTORIC_TABLE: !Ref WorkflowHistoricTable
      SHOULD_ASSIGN_TEST_USER: "${{file(./src/resources/config.yml):ShouldAssignTestUsers-${{self:provider.stage}}}}"
    vpc:
        securityGroupIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkSecurityGroup}}"
        subnetIds:
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet1}}"
          - !ImportValue "${{file(./src/resources/config.yml):NetworkPrivateSubnet2}}"
